<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rastrear Pedido - NovaShop</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/rastrear.css}">
</head>
<body>
<!-- Navbar -->
<div th:replace="~{fragments/navbar :: navbar}"></div>

<!-- Alertas -->
<div th:replace="~{fragments/navbar :: alerts}"></div>

<!-- Página de Rastreo -->
<section class="tracking-page">
    <div class="container">

        <!-- Card Principal de Rastreo -->
        <div class="tracking-card">
            <div class="tracking-icon">
                <i class="bi bi-search"></i>
            </div>

            <h1 class="tracking-title">Rastrea tu Pedido</h1>
            <p class="tracking-subtitle">
                Ingresa tu número de pedido para ver el estado de tu envío
            </p>

            <!-- Formulario de Rastreo -->
            <form th:action="@{/pedidos/rastrear}" method="post">
                <div class="tracking-input-group">
                    <i class="bi bi-hash"></i>
                    <input type="text"
                           name="numeroPedido"
                           placeholder="NS-202510-001234"
                           required
                           pattern="NS-\d{6}-\d{6}"
                           title="Formato: NS-YYYYMM-NNNNNN"
                           maxlength="20"
                           id="trackingInput">
                </div>

                <button type="submit" class="btn btn-track">
                    <i class="bi bi-search me-2"></i>
                    Rastrear Pedido
                </button>
            </form>

            <!-- Ejemplo de Número -->
            <div class="example-number">
                <p>
                    <i class="bi bi-lightbulb me-2"></i>
                    Ejemplo de formato: <strong>NS-202510-001234</strong>
                </p>
            </div>

            <!-- Información sobre el Rastreo -->
            <div class="tracking-info">
                <h5>
                    <i class="bi bi-info-circle"></i>
                    ¿Dónde encuentro mi número de pedido?
                </h5>

                <div class="info-item">
                    <i class="bi bi-envelope"></i>
                    <div>
                        En el <strong>correo de confirmación</strong> que te enviamos al realizar tu compra
                    </div>
                </div>

                <div class="info-item">
                    <i class="bi bi-person-circle"></i>
                    <div>
                        En la sección <strong>"Mis Pedidos"</strong> de tu cuenta
                    </div>
                </div>

                <div class="info-item">
                    <i class="bi bi-receipt"></i>
                    <div>
                        En el <strong>recibo o comprobante</strong> de tu compra
                    </div>
                </div>
            </div>
        </div>

        <!-- Características del Servicio -->
        <div class="tracking-features">
            <div class="feature-item">
                <i class="bi bi-clock-history"></i>
                <h6>Actualización en Tiempo Real</h6>
                <p>Seguimiento constante de tu pedido</p>
            </div>

            <div class="feature-item">
                <i class="bi bi-bell"></i>
                <h6>Notificaciones</h6>
                <p>Te avisamos de cada cambio de estado</p>
            </div>

            <div class="feature-item">
                <i class="bi bi-truck"></i>
                <h6>Envío Rápido</h6>
                <p>Entrega en 5-7 días hábiles</p>
            </div>

            <div class="feature-item">
                <i class="bi bi-shield-check"></i>
                <h6>Compra Protegida</h6>
                <p>Tu pedido está 100% seguro</p>
            </div>
        </div>

        <!-- Sección de Ayuda -->
        <div class="help-section">
            <h5>¿Necesitas más ayuda?</h5>
            <p>Nuestro equipo de soporte está disponible para ayudarte</p>

            <div class="help-buttons">
                <a th:href="@{/mi-cuenta/pedidos}" class="btn btn-primary">
                    <i class="bi bi-box-seam me-2"></i>
                    Ver Mis Pedidos
                </a>

                <a href="#" class="btn btn-outline-light">
                    <i class="bi bi-chat-dots me-2"></i>
                    Chat en Vivo
                </a>

                <a href="tel:+51999888777" class="btn btn-outline-light">
                    <i class="bi bi-telephone me-2"></i>
                    Llamar Soporte
                </a>
            </div>

            <div class="mt-4">
                <p class="small mb-0">
                    <i class="bi bi-headset me-2"></i>
                    Atención al cliente: Lun - Vie, 9:00 - 18:00<br>
                    <i class="bi bi-envelope me-2"></i>
                    Email: soporte@novashop.com<br>
                    <i class="bi bi-telephone me-2"></i>
                    Teléfono: +51 999 888 777
                </p>
            </div>
        </div>

    </div>
</section>

<!-- Footer -->
<div th:replace="~{fragments/footer :: footer}"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // Auto-formatear el input mientras escribe
    document.getElementById('trackingInput').addEventListener('input', function(e) {
        let value = e.target.value.toUpperCase().replace(/[^A-Z0-9-]/g, '');

        // Formatear automáticamente: NS-XXXXXX-XXXXXX
        if (value.length > 0 && !value.startsWith('NS-')) {
            value = 'NS-' + value.replace('NS', '').replace(/-/g, '');
        }

        // Agregar guiones automáticamente
        if (value.length > 9 && value.indexOf('-', 3) === -1) {
            value = value.slice(0, 9) + '-' + value.slice(9);
        }

        e.target.value = value;
    });

    // Validación antes de enviar
    document.querySelector('form').addEventListener('submit', function(e) {
        const input = document.getElementById('trackingInput');
        const value = input.value.trim();

        if (!value.match(/^NS-\d{6}-\d{6}$/)) {
            e.preventDefault();
            alert('Por favor, ingresa un número de pedido válido.\nFormato: NS-202510-001234');
            input.focus();
            return false;
        }
    });
</script>
</body>
</html>